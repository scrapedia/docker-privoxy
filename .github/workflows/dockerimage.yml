name: Docker Image CI

on: [push]

jobs:

  shellcheck:

    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v1
      - name: Install shellcheck
        run: |
          scversion="stable"
          wget -qO- "https://storage.googleapis.com/shellcheck/shellcheck-${scversion?}.linux.x86_64.tar.xz" | tar -xJv
          sudo cp "shellcheck-${scversion}/shellcheck" /usr/bin/
          shellcheck --version
      - name: shell check
        run: shellcheck versions/alpine/docker-entrypoint.sh

  build:

    needs: shellcheck

    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v1
      - name: Build the Docker image
        run: docker build --tag scrapedia/privoxy:$(date +%s) --file Dockerfile .
        working-directory: versions/alpine
